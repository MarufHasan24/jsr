const cnsl=cons,inp=inputdiv,head=scriptm;function main(e){const t={JSON:JSON,Number:Number,String:String,Error:Error};var r=!1;globalThis.global={jro:function(...e){for(var r="",n=0;n<e.length;n++){var l=e[n];r+=t.JSON.stringify(l,(function(e,t){return"function"==typeof t?"f "+e+"() {[code]}":t})).replace(/"/g,"")}cnsl.innerHTML+="$ "+r+"\n"},jrin:function(e){return new Promise(((t,r)=>{inp.innerHTML="",inp.innerHTML='<div style="color: #fff;">'+e+'</div><input type="text" name="prompt" id="prompttxt" spellcheck="true" autocomplete="off">';let n=document.getElementById("prompttxt");n.innerHTML="",n.focus(),n.addEventListener("keyup",(e=>{"Enter"==e.key?(t(n.value),inp.innerHTML=""):"Escape"==e.key&&(r(),inp.innerHTML="")}))}))},clear:function(){cnsl.innerHTML=""},exit:function(e){throw cnsl.innerHTML+="$_",new t.Error(e)},sleep:function(e){return new Promise((t=>setTimeout(t,e)))},num:e=>t.Number(e),str:e=>t.String(e),abs:e=>e<0?-e:e,fact:function(e){return 0==e?1:e*this.fact(e-1)},XOR:function(e,t){return!e&&t||e&&!t},XNOR:function(e,t){return!e&&!t||e&&t},NOR:function(e,t){return!(e||t)},NAND:function(e,t){return!(e&&t)}};var n="",l=[],o=(e=e.replace(/\/\/.+/g,"").replace(/\n|\r/g,"").replace(/\s+/g," ").replace(/'.*?'/g,"").replace(/\"[\s\S]*?\"/g,(function(e){return l.push(e),"<token:s"+(l.length-1)})).replace(/clear\(\)/g,"global.clear()").replace(/exit\(/g,"global.exit(").replace(/sleep\(/g,"await global.sleep(").replace(/`/g,"\\`").trim(),[]);const a=e.replace(/>(?=.*?\{)/g,"><token:devider>").replace(/}/g,"<token:x2775><token:devider>").replace(/function\s([\w\d\$\_])+\([\w\d\$\_\s{},\[\]]*\)\s?{/g,(function(e){return o.push(e),"<token:devider><token:f"+(o.length-1)})).replace(/{/g,"<token:x2774><token:devider>").split("<token:devider>").filter((e=>e));let c="";for(let e=0;e<a.length;e++)c+=s(a[e]);function s(e){let t=1,l=/\w+\s*\w*\(?.*\)?\{/g,a=/(velc|velt)\s+\w+\s+=\s*{(\w+:.*,?)*}/g,c=e.match(/^(var|let|const)\s+/g);if(c)throw new Error("SyntaxError: Unexpected token '"+c+"'");let s="";(e=e.replace(/(var|let|const|main)/g,(function(e){return"_"+e}))).includes("#include")&&(e=function(e){return e.replace(/#include\s?\<[\w\d\,]+\>/g,(function(e){let t=e.replace(/#include\<|\>/g,"");if("global"==t)global.date=Date,global.math=Math,global.json=JSON,global.error=function(...e){throw new Error(...e)};else{if(!t.includes("std")||r)throw"started without std";r=!0,t.includes("json")&&(global.json=JSON),t.includes("error")&&(global.error=function(...e){throw new Error(...e)}),t.includes("math")?n+='let math = await import("./math_laibrary.js");':t.includes("num")?(Number.__proto__.odd=function(){return this%2!=0},Number.__proto__.prime=function(){if(!(this>0))throw"Require a positive number";if(2===this)return!0;if(!(this>1))return!1;for(let e=2;e<this;e++)return this%e!=0},Number.__proto__.fact=function(){let e=1;if(this>0){for(let t=1;t<=this;t++)e*=t;return e}throw"Require a positive number"}):Number=void 0,t.includes("date")&&(global.date=Date),t.includes("arr")&&(Array.__proto__.range=function(e,t,r){void 0===r&&(r=1);let n=[];if(e<t)for(let l=e;l<t;l+=r)n.push(l);else for(let l=e;l>t;l+=r)n.push(l);return n},Array.__proto__.sum=function(){let e=0;for(let t=0;t<this.length;t++)e+=this[t];return e},Array.__proto__.product=function(){let e=1;for(let t=0;t<this.length;t++)e*=this[t];return e},Array.__proto__.mean=function(){return this.sum()/this.length},Array.__proto__.median=function(){let e=this.sort();return e.length%2==0?(e[e.length/2]+e[e.length/2-1])/2:e[Math.floor(e.length/2)]},Array.__proto__.mode=function(){let e={};for(let t=0;t<this.length;t++)void 0===e[this[t]]?e[this[t]]=1:e[this[t]]+=1;let t,r=0;for(let n in e)e[n]>r&&(r=e[n],t=n);return t},Array.__proto__.GCD=function(){}),t.includes("str")?addStrProto():String=void 0,t.includes("bool")||(Boolean=void 0),t.includes("func")&&(global.Func=Function),t.includes("reg")||(RegExp=void 0)}return JSON=void 0,Date=void 0,Error=void 0,""})).replace(/#include\s<"[\w\d]+"\|[\w\d]+?>/g,(e=>{let t=e.replace(/#include<"|"|>/g,"").split("|");return"const "+t[1]+" = await import('"+t[0]+"');"}))}(e)),e.includes(";")?(s=e.replace(/;/g,";<token:003B>").split("<token:003B>"),t=s.length,s[t-1]||(s.pop(),t--)):s=[e];let u="",p="";for(let e=t-1;e>=0;--e){let t=s[e];if(t.includes("=+")){let e=t.replace(/;/g,"").split("=+");t=e[0]+"="+e[1]+"+"+e[0]+";"}else if(t.includes("=-")){let e=t.replace(/;/g,"").split("=-");t=e[0]+"="+e[1]+"-"+e[0]+";"}else if(t.includes("=*")){let e=t.replace(/;/g,"").split("=*");t=e[0]+"="+e[1]+"*"+e[0]+";"}else if(t.includes("=/")){let e=t.replace(/;/g,"").split("=/");t=e[0]+"="+e[1]+"/"+e[0]+";"}else if(t.includes("=%")){let e=t.replace(/;/g,"").split("=%");t=e[0]+"="+e[1]+"%"+e[0]+";"}t=t.replace(/dt\(/,"new global.date(").replace(/jrin\(/g,"await global.jrin(").replace(/jro\(/g,"global.jro(").replace(/json\./g,"global.json.").replace(/(?<!\w\$\_)exclude\s/g,"delete ").replace(/(?<!\w\$\_)error(?!\w\d\$\_)/g," global.error").replace(/(?<!\w\$\_)String(?!\w\d\$\_)/g," global.string").replace(/(?<!\w\$\_)Number(?!\w\d\$\_)/g," global.number").replace(/(?<!\w\$\_)Boolean(?!\w\d\$\_)/g," global.boolean").replace(/(?<!\w\$\_)Func(?!\w\d\$\_)\(/g," global.Func(").replace(/(?<!\w\$\_)velc(?!\w\d\$\_)\s/g,"const ").replace(/(?!\w\$\_)velt(?!\w\d\$\_)\s/g,"let ").replace(/(?<!\w\$\_)num(?!\w\d\$\_)\(/g," global.num(").replace(/(?<!\w\$\_)str(?!\w\d\$\_)\(/g," global.str(").replace(/(?<!\w\$\_)eval(?!\w\d\$\_)\(/g,"evaluate(").replace(/[\d\w]+\s?\^\s?[\d\w]+/g,(e=>"global.XOR("+e.replace(/\s?\^\s?/,",")+")")).replace(/[\d\w]+\s?\!\^\s?[\d\w]+/g,(e=>"global.XNOR("+e.replace(/\s?\!\^\s?/,",")+")")).replace(/[\d\w]+\s?\!\|\s?[\d\w]+/g,(e=>"global.NOR("+e.replace(/\s?\!\|\s?/,",")+")")).replace(/[\d\w]+\s?\!\&\s?[\d\w]+/g,(e=>"global.NAND("+e.replace(/\s?\!\&\s?/,",")+")")).replace(/\|[+-\d\w]+\|/g,(function(e){return"global.abs("+e.replace(/\|/g,"")+")"})).replace(/[\d\w]+!/,(function(e){return"global.fact("+e.replace(/!/,"")+")"})).replace(/(?<=for\(.+),/g,";"),";"===t&&(p=";"),u+=t}if(u=p+u,l.test(u)&&!a.test(u)){let e=u.match(l);for(u=u.replace(l,""),i=0;i<e.length;i++)u+=e[i]}if(a.test(u)){let e=u.match(a),t="";for(i=0;i<e.length;i++)t+=e[i]+";";u=u.replace(a,""),u=t+u}if(u=u.replace(/;+/g,";"),u.includes("<token:x2774>")&&(u=u.replace("<token:x2774>","")+"{"),u.includes("<token:x2775>")&&(u=u.replace("<token:x2775>","")+"}"),u.match(/<token:f\d+/g)){let e=u.match(/<token:f\d+/g);for(let t=0;t<e.length;t++){let r=parseInt(e[t].replace(/<token:f/,""));u=u.replace(e[t],""),u=o[r]+u}}return u}return c=c.replace(/<token:s\d+/g,(function(e){let t=parseInt(e.replace(/<token:s/,""));return l[t]})),l=void 0,"(async function () {"+n+c+"})()"}function run(){localStorage.setItem("ide",ide.value),rundiv.disabled=!0;var ap=async()=>await new Promise(((resolve,reject)=>{try{resolve(eval(main(ide.value)))}catch(e){reject(e)}}));ap().then((e=>{})).catch((e=>{let t="string"!=typeof e?e.message?.replace(/import/g,"include").replace(/global\./g,"")?.replace(/_(var|let|const|main)/g,(function(e){return e.replace("_","")})):e;cons.innerHTML+=t.includes("Exit code ")?t:"\nError >"+t}))}